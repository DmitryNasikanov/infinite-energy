---
title: "3.1.4 Линия титана"
sidebar: science
execute:
  echo: false
---

```{ojs}
//| output: false

// Загрузка данных из JSON
dataScript = FileAttachment("../../../data/db/data.json").json()

// Материалы доступные на Меркурии

mercuryMaterials = new Set(
  dataScript.planetMaterials
    .filter(pm => pm.planet_id === "mercury")
    .map(pm => pm.material_id)
)

// Словари для быстрого поиска
materialsById = new Map(dataScript.materials.map(m => [m.id, m]))
unitsById = new Map(dataScript.units.map(u => [u.id, u]))
planetsById = new Map(dataScript.planets.map(p => [p.id, p]))

// Функция для получения материалов компонента
function getComponentMaterials(componentId) {
  return dataScript.unitMaterials
    .filter(um => um.unit_id === componentId)
    .map(um => {
      const material = materialsById.get(um.material_id);
      return {
        symbol: material?.symbol,
        name: material?.name || um.material_id,
        fraction_pct: um.fraction_pct,
        isLocal: mercuryMaterials.has(um.material_id)
      };
    });
}

// Функция для отображения виджета единицы
function unitWidget(unitId) {
  const unit = unitsById.get(unitId);
  if (!unit) return html`<div class="db-widget">Единица ${unitId} не найдена</div>`;

  const planet = planetsById.get(unit.production_planet_id);

  // Материалы базового юнита
  const materials = dataScript.unitMaterials
    .filter(um => um.unit_id === unitId)
    .map(um => {
      const material = materialsById.get(um.material_id);
      const isLocal = mercuryMaterials.has(um.material_id);
      const massKg = unit.mass_kg ? (unit.mass_kg * um.fraction_pct / 100).toFixed(0) : null;
      return { ...um, material, isLocal, massKg };
    });

  // Компоненты (подсборки)
  const components = dataScript.unitComponents
    .filter(uc => uc.assembly_id === unitId)
    .map(uc => {
      const component = unitsById.get(uc.component_id);
      const totalMassKg = component?.mass_kg ? (component.mass_kg * uc.quantity) : null;
      const isLocal = component?.production_planet_id === unit.production_planet_id;
      const componentMaterials = getComponentMaterials(uc.component_id);

      return {
        id: uc.component_id,
        name: component?.name || uc.component_id,
        quantity: uc.quantity,
        massKg: totalMassKg,
        isLocal,
        materials: componentMaterials
      };
    });

  // Итого считаем ТОЛЬКО по материалам (не компонентам!)
  const localPct = materials.filter(m => m.isLocal).reduce((sum, m) => sum + m.fraction_pct, 0);
  const importPct = materials.filter(m => !m.isLocal).reduce((sum, m) => sum + m.fraction_pct, 0);
  const hasCriticalImports = components.some(c => !c.isLocal);

  // Строки таблицы компонентов
  const componentRows = components.map(c => html`
    <tr class="component-row">
      <td>
        <strong>${c.name}</strong>${c.quantity > 1 ? html` ×${c.quantity}` : ''}
        <div class="component-materials">
          ${c.materials.map(m => html`<span class="${m.isLocal ? 'local' : 'import'}">${m.symbol || m.name} ${m.fraction_pct}%</span>`)}
        </div>
      </td>
      <td>${c.massKg ? c.massKg.toFixed(0) : '—'} кг</td>
      <td class="${c.isLocal ? 'local' : 'import'}">${c.isLocal ? '✓' : '⚠ импорт'}</td>
    </tr>
  `);

  // Строки таблицы материалов
  const materialRows = materials.map(m => html`
    <tr>
      <td>
        ${m.material?.symbol ? html`<strong>${m.material.symbol}</strong> ` : ''}
        ${m.material?.name || m.material_id}
      </td>
      <td>${m.fraction_pct}%</td>
      <td>${m.massKg || '—'} кг</td>
      <td class="${m.isLocal ? 'local' : 'import'}">${m.isLocal ? '✓ местный' : '⚠ импорт'}</td>
    </tr>
  `);

  return html`
    <div class="db-widget">
      <h4>${unit.name} <span style="color: #6c757d; font-weight: normal;">(${unit.id})</span></h4>
      <div class="meta">
        ${unit.mass_kg ? html`<strong>${unit.mass_kg.toLocaleString()}</strong> кг` : ''}
        ${unit.power_kw ? html` | <strong>${unit.power_kw.toLocaleString()}</strong> кВт` : ''}
        ${planet ? html` | Производство: ${planet.name}` : ''}
      </div>

      ${components.length > 0 ? html`
        <div class="section-header">Компоненты</div>
        <table class="components-table">
          <thead><tr><th>Компонент</th><th>Масса</th><th>Источник</th></tr></thead>
          <tbody>${componentRows}</tbody>
        </table>
      ` : ''}

      ${materials.length > 0 ? html`
        <div class="section-header">Материалы</div>
        <table class="materials-table">
          <thead><tr><th>Материал</th><th>%</th><th>Масса</th><th>Источник</th></tr></thead>
          <tbody>${materialRows}</tbody>
        </table>
        <div class="summary">
          Итого: <span class="local-pct">${localPct.toFixed(0)}% местное</span> |
          <span class="import-pct">${importPct.toFixed(0)}% импорт</span>
          ${hasCriticalImports ? html`<br/><strong>⚠ Содержит импортные компоненты</strong>` : ''}
        </div>
      ` : ''}

      <div class="link">
        <a href="data/nomenclature.html?unit=${unitId}">Подробнее →</a>
      </div>
    </div>
  `;
}
```

## Обзор

| Параметр | Значение |
|----------|----------|
| Вход | Магнитная фракция (ильменит FeTiO₃ + троилит FeS) |
| Выход | TiO₂, S, Fe₂O₃ |
| Производительность | ~33 т/день |
| Назначение | Электрохромика зеркал |

← [Назад к обзору](overview.qmd)

---

## Назначение линии

Извлечение TiO₂ для электрохромики зеркал. Титан (<1% в коре Меркурия) находится в **ильмените (FeTiO₃)** — слабомагнитном минерале.

| Параметр | Значение |
|----------|----------|
| Потребность TiO₂ | 1 кг × 600 зеркал = **0.6 т/день** |
| Доступно (Ti <1%) | ~4.5 т TiO₂ из 270 т реголита |
| Запас | **×7.5** (избыток) |

---

## Схема процесса

```{mermaid}
flowchart TD
    subgraph ВХОД["МАГНИТНАЯ ФРАКЦИЯ"]
        MF[/"Ильменит + Троилит<br/>33 т/день"/]
    end

    subgraph ВОЗГОНКА["ВОЗГОНКА СЕРЫ"]
        MF --> TS["Нагрев до 450°C<br/>(в вакууме)"]
        TS -->|"S↗"| S_COND["Конденсатор"]
        S_COND --> S_OUT[/"Сера<br/>~18 т/день"/]
    end

    subgraph ОБЖИГ["ОКИСЛИТЕЛЬНЫЙ ОБЖИГ"]
        TS -->|"FeS → FeO"| OX["Обжиг 900°C<br/>+ O₂"]
        OX --> FeTi["FeO + TiO₂"]
    end

    subgraph СЕПАРАЦИЯ["МАГНИТНАЯ СЕПАРАЦИЯ"]
        FeTi --> SEP["Магнитный<br/>сепаратор"]
        SEP -->|"магнитное"| FE_OUT[/"Fe₂O₃<br/>→ MRE"/]
        SEP -->|"немагнитное"| TI_OUT[/"TiO₂<br/>→ электрохромика"/]
    end

    style ВОЗГОНКА fill:#fff3cd
    style ОБЖИГ fill:#f8d7da
    style СЕПАРАЦИЯ fill:#d4edda
```

| Этап | Описание | Температура |
| :--- | :--- | :--- |
| Возгонка серы | Нагрев магнитной фракции в вакууме | 450°C |
| Окислительный обжиг | Окисление FeS → Fe₂O₃ | 900°C |
| Магнитная сепарация | Разделение Fe₂O₃ (магнитное) и TiO₂ (немагнитное) | — |

---

## Возгонка серы

Троилит (FeS) — источник серы для NaS-батарей.

| Параметр | Значение |
| :--- | :--- |
| Реакция | FeS → Fe + S↑ (при 450°C в вакууме) |
| Сера испаряется | Конденсируется на холодной поверхности |
| Выход | ~18 т серы/день |

**Конденсатор серы:**
- Холодная поверхность в тени (−150°C)
- Сера осаждается жёлтыми кристаллами
- Переплавка: жидкая сера (>115°C) → в аккумуляторный цех

> **Примечание:** Вакуум снижает температуру сублимации серы, что экономит энергию.

---

## Окислительный обжиг

После удаления серы остаётся смесь FeO и FeTiO₃. Обжиг в присутствии кислорода:

| Реакция | Продукт |
| :--- | :--- |
| 2FeO + ½O₂ → Fe₂O₃ | Гематит (магнитный) |
| FeTiO₃ + ½O₂ → Fe₂O₃ + TiO₂ | Гематит + рутил |

**Параметры:**

| Параметр | Значение |
| :--- | :--- |
| Температура | 900°C |
| Атмосфера | O₂ (из MRE-ячейки) |
| Время | 2-4 часа |

---

## Магнитная сепарация Fe₂O₃/TiO₂

После обжига смесь разделяется магнитным сепаратором:

| Фракция | Магнитные свойства | Продукт |
| :--- | :--- | :--- |
| Fe₂O₃ (гематит) | Магнитный | Возвращается в MRE-ячейку |
| TiO₂ (рутил) | Немагнитный | Идёт на электрохромику |

> **Примечание:** Fe₂O₃ — ценное сырьё, возвращается в основной цикл для извлечения железа.

---

## Электрохромика зеркал

TiO₂ используется для управления ориентацией зеркала в космосе:

| Компонент | Функция |
|-----------|---------|
| Слой TiO₂ | Изменяет отражательную способность при подаче напряжения |
| Эффект | Неравномерное давление света → крутящий момент |
| Управление | Наклон зеркала без двигателей и топлива |

**Принцип:** Зеркало 100×100 м с электрохромным покрытием. При подаче напряжения на один край отражательная способность снижается → давление света становится неравномерным → зеркало медленно поворачивается. Это позволяет направлять отражённый свет на приёмник без расхода топлива.

**Масса электрохромного слоя:** ~1 кг/зеркало (из 116 кг общей массы).

### Преимущества электрохромного управления

- Нет расходуемого топлива
- Нет механических частей
- Работает от солнечных батарей
- Срок службы = срок службы зеркала

---

## Выход продуктов

| Продукт | Количество | Применение |
| :--- | :--- | :--- |
| TiO₂ (рутил) | ~3 т/день | Электрохромика зеркал |
| Сера (S) | ~18 т/день | NaS батареи |
| Fe₂O₃ (гематит) | ~12 т/день | Возврат в MRE → железо |

---

## Источники

- **MESSENGER Mission (2011-2015)** — Данные о составе поверхности Меркурия
- **Electrochromic Materials** — Исследования TiO₂ покрытий
- **Space Mirror Control** — Технологии ориентации космических зеркал

---

## См. также

- [Переработка реголита](overview.qmd) — обзор процесса
- [Накопители](../robots/elements/batteries.qmd) — NaS батареи из серы
- [Зеркала](../../mirrors.qmd) — конструкция и управление
