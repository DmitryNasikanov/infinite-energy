---
title: "4.2 Линия железа (подготовка материалов)"
sidebar: science
execute:
  echo: false
---

```{ojs}
//| output: false

// Загружаем данные из JSON
dataScript = FileAttachment("../data/db/data.json").json()

// Материалы доступные на Меркурии
mercuryMaterials = new Set(
  dataScript.planetMaterials
    .filter(pm => pm.planet_id === "mercury")
    .map(pm => pm.material_id)
)

// Словари для быстрого поиска
materialsById = new Map(dataScript.materials.map(m => [m.id, m]))
unitsById = new Map(dataScript.units.map(u => [u.id, u]))
planetsById = new Map(dataScript.planets.map(p => [p.id, p]))

// Функция для отображения виджета единицы
function unitWidget(unitId) {
  const unit = unitsById.get(unitId);
  if (!unit) return html`<div class="db-widget">Единица ${unitId} не найдена</div>`;

  const planet = planetsById.get(unit.production_planet_id);

  // BOM для этой единицы
  const bom = dataScript.unitMaterials
    .filter(um => um.unit_id === unitId)
    .map(um => {
      const material = materialsById.get(um.material_id);
      const isLocal = mercuryMaterials.has(um.material_id);
      const massKg = unit.mass_kg ? (unit.mass_kg * um.fraction_pct / 100).toFixed(2) : null;
      return { ...um, material, isLocal, massKg };
    });

  // Расчёт итогов
  const localPct = bom
    .filter(b => b.isLocal)
    .reduce((sum, b) => sum + b.fraction_pct, 0);
  const importPct = bom
    .filter(b => !b.isLocal)
    .reduce((sum, b) => sum + b.fraction_pct, 0);

  const bomRows = bom.map(b => html`
    <tr>
      <td>${b.material?.symbol ? html`<strong>${b.material.symbol}</strong> ` : ''}${b.material?.name || b.material_id}</td>
      <td>${b.fraction_pct}%</td>
      <td>${b.massKg || '—'}</td>
      <td class="${b.isLocal ? 'local' : 'import'}">${b.isLocal ? '✓ местный' : '⚠ импорт'}</td>
    </tr>
  `);

  return html`
    <div class="db-widget">
      <h4>${unit.name} <span style="color: #6c757d; font-weight: normal;">(${unit.id})</span></h4>
      <div class="meta">
        ${unit.mass_kg ? html`<strong>${unit.mass_kg.toLocaleString()}</strong> кг` : ''}
        ${unit.power_kw ? html` | <strong>${unit.power_kw.toLocaleString()}</strong> кВт` : ''}
        ${planet ? html` | Производство: ${planet.name}` : ''}
      </div>
      ${bom.length > 0 ? html`
        <table>
          <thead>
            <tr><th>Материал</th><th>%</th><th>кг</th><th>Источник</th></tr>
          </thead>
          <tbody>${bomRows}</tbody>
        </table>
        <div class="summary">
          Итого: <span class="local-pct">${localPct.toFixed(0)}% местное</span> | <span class="import-pct">${importPct.toFixed(0)}% импорт</span>
        </div>
      ` : ''}
      <div class="link">
        <a href="../data/nomenclature.html?unit=${unitId}">Подробнее →</a>
      </div>
    </div>
  `;
}
```

## Обзор

| Параметр | Значение |
|----------|----------|
| Вход | Fe/Si расплав 35 т/день из [MRE](line-mre.qmd) |
| Выход | Полуфабрикаты: заготовки, прокат, проволока |
| Производительность | ~18 т Fe/день (остальное Si → зонная плавка) |
| Энергопотребление | МНЛЗ 100 кВт + печь 200 кВт + прокат 200 кВт |

← [Назад к обзору](../factory-interior.qmd)

---

## Поток материалов

```{mermaid}
flowchart TD
    subgraph INPUT["ВХОД"]
        MRE["MRE-ячейка<br/>line-mre"]
        MRE -->|"Fe/Si 35т/день<br/>1500°C"| MHD["МГД-ввод"]
    end

    subgraph CASTING["ЛИТЕЙНАЯ ЗОНА"]
        MHD --> TUNDISH["Промковш<br/>EQU-023"]
        TUNDISH --> MNLZ_FE["МНЛЗ-Fe<br/>EQU-007"]
        MNLZ_FE --> BILLETS_FE["Заготовки 100×100 мм"]
    end

    subgraph HEATING["НАГРЕВ"]
        BILLETS_FE --> FURNACE["Индукционная печь<br/>EQU-024<br/>1100°C, N₂"]
    end

    subgraph ROLLING["ПРОКАТНАЯ ЗОНА"]
        FURNACE --> MILL["Прокатный стан<br/>EQU-008<br/>6 клетей"]
        MILL --> ROD["Пруток Ø20 мм"]
        ROD --> WIRE_DRAW["Волочильный стан"]
    end

    subgraph OUTPUT["ПОЛУФАБРИКАТЫ"]
        WIRE_DRAW --> WIRE_OUT["Проволока<br/>Ø1.6-2.0 мм<br/>~15 т/день"]
        MILL --> SHEET_FE["Прокат Fe<br/>листы/профили<br/>~3 т/день"]
    end

    style INPUT fill:#f0e68c
    style CASTING fill:#fff3cd
    style HEATING fill:#ffe4b5
    style ROLLING fill:#d4edda
    style OUTPUT fill:#cce5ff
```

---

## Детальное описание

### МГД-ввод ферросилиция

Расплав Fe-Si из MRE-ячейки (состав: Fe ~51%, Si ~49%) транспортируется через МГД-канал в купол фабрики. Кремний отделяется позже через зонную плавку для производства солнечных панелей и электроники.

### Промковш (тандиш)

Буферная ёмкость с двумя стопорами, разделяющая потоки Al и Fe/Si. Подробнее см. [Линия алюминия](factory-line-aluminum.qmd).

```{ojs}
unitWidget("EQU-023")
```

### МНЛЗ-Fe (Машина непрерывного литья железа)

Непрерывное литьё заготовок 100×100 мм из ферросилиция. Медный кристаллизатор с водяным охлаждением.

```{ojs}
unitWidget("EQU-007")
```

### Индукционная печь

Нагрев заготовок до 1100°C в атмосфере азота (N₂) для предотвращения окисления перед прокатом.

**Параметры**:
- Температура: 1100°C
- Атмосфера: N₂ (предотвращает окисление)
- Мощность: 200 кВт

```{ojs}
unitWidget("EQU-024")
```

### Прокатный стан

6-клетьевой прокатный стан для прокатки заготовок до прутка Ø20 мм. Часть прутка идёт на дальнейшее волочение, часть - на листовой прокат.

```{ojs}
unitWidget("EQU-008")
```

### Волочение проволоки

Волочильный стан с фильерами из вольфрама (W) для производства проволоки Ø1.6-2.0 мм. Проволока используется в WAAM 3D-печати для создания рам роботов.

---

## Материальный баланс полуфабрикатов

| Полуфабрикат | т/день | Назначение |
|--------------|--------|------------|
| Проволока Fe Ø1.6-2.0 мм | ~15 | [Сборка роботов](factory-assembly-robots.qmd) - WAAM 3D-печать рам |
| Прокат Fe (листы/профили) | ~3 | Крепления, рельсы, инструменты |
| **Итого Fe** | **~18** | |
| Si → зонная плавка | ~17 | Солнечные панели, электроника |

**Примечание**: Железо с Меркурия содержит ~6% Mn (марганец), что автоматически даёт низколегированную сталь с повышенной прочностью (данные MESSENGER).

---

## См. также

- [MRE-электролиз](line-mre.qmd) - источник ферросилиция
- [Линия алюминия](factory-line-aluminum.qmd) - Al корпуса для роботов
- [Сборка роботов](factory-assembly-robots.qmd) - использует Fe проволоку и Al листы
