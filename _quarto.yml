project:
  type: website
  output-dir: _output
  render:
    - "*.qmd"
    - "ru/"
    - "en/"
    - "!share/"
    - "!venv/"
    - "!worldbuilding/"
    - "!marketing/"

format:
  html:
    theme: cosmo
    css: ru/science/data/widgets.css
    mermaid:
      theme: neutral
    toc: true
    toc-depth: 3
    code-fold: true
    include-in-header:
      text: |
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-WW2S48BBEP"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-WW2S48BBEP');
        </script>
        <style>
        .content { max-width: 900px; }
        p { text-indent: 1.5em; margin-top: 0.3em; margin-bottom: 0.3em; text-align: justify; }
        h1 + p, h2 + p, h3 + p, h4 + p { text-indent: 0; }
        p:has(img), .quarto-figure, .figure { text-indent: 0; }
        p:has(> strong:first-child) { text-indent: 0; }
        p:has(> em:first-child) { text-indent: 0; }
        /* –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ outline-–∫–Ω–æ–ø–∫–∏ */
        .btn-outline {
          display: inline-block;
          padding: 0.8rem 2rem;
          border: 2px solid #555;
          border-radius: 8px;
          color: #555;
          text-decoration: none;
          font-weight: 500;
          transition: all 0.2s ease;
          background: transparent;
          text-align: center;
        }
        .btn-outline:hover {
          background: #555;
          color: #fff;
          text-decoration: none;
        }
        .btn-outline-primary {
          border-color: #0d6efd;
          color: #0d6efd;
        }
        .btn-outline-primary:hover {
          background: #0d6efd;
          color: #fff;
        }
        /* –ê–∫—Ç–∏–≤–Ω—ã–π —è–∑—ã–∫ –≤ dropdown */
        .dropdown-item.active {
          font-weight: bold;
          background-color: rgba(0,0,0,0.05);
          color: inherit !important;
        }
        </style>
        <script>
        // Language switcher - handles GitHub Pages subdirectory
        const LANG_FLAGS = { ru: 'üá∑üá∫', en: 'üá¨üáß' };  // For matching dropdown items
        const LANG_LABELS = { ru: 'RU', en: 'EN' };   // For navbar indicator

        // Translation map for navigation labels (RU ‚Üí EN)
        const TRANSLATIONS = {
          // Navbar
          '–ü—Ä–æ–µ–∫—Ç –ì–µ–ª–∏–æ—Å': 'Project Helios',
          '–ö–Ω–∏–≥–∞': 'Book',
          '–ù–∞—É–∫–∞': 'Science',
          '–û–± –∞–≤—Ç–æ—Ä–µ': 'About',
          // Sidebar sections
          '–û–±–∑–æ—Ä': 'Overview',
          '–°–≤–æ–¥–Ω—ã–µ —Å—Ç–∞—Ç—å–∏': 'Summary Articles',
          '–î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–º—ã': 'Detailed Topics',
          '–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏': 'Reference',
          // Executive summary
          '–ü—Ä–æ–µ–∫—Ç ¬´–ì–µ–ª–∏–æ—Å¬ª –∑–∞ 5 –º–∏–Ω—É—Ç': 'Project Helios in 5 Minutes',
          // Summary articles
          '–ü–æ—á–µ–º—É –ú–µ—Ä–∫—É—Ä–∏–π?': 'Why Mercury?',
          '–õ—É–Ω–∞': 'Moon',
          '–ë—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞': 'Project Budget',
          '–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞': 'Roadmap',
          '–ú–∞—Ä—Å (–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞)': 'Mars (Perspective)',
          // Main detailed topics
          '–ó–µ—Ä–∫–∞–ª–∞ –†–æ—è': 'Swarm Mirrors',
          '–ì–µ–æ–º–µ—Ç—Ä–∏—è –æ—Ç—Ä–∞–∂–µ–Ω–∏—è': 'Reflection Geometry',
          '–•–∞–± –ø—Ä–∏—ë–º–∞ —ç–Ω–µ—Ä–≥–∏–∏': 'Energy Reception Hub',
          '–≠–Ω–µ—Ä–≥–æ—Å–∏—Å—Ç–µ–º–∞ –ú–µ—Ä–∫—É—Ä–∏—è': 'Mercury Power System',
          '–î–æ—Å—Ç–∞–≤–∫–∞': 'Delivery',
          '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ': 'Production',
          // Production section
          '–ù–∞–≤–∏–≥–∞—Ü–∏—è': 'Navigation',
          '–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–æ–ª–∏—Ç–∞': 'Regolith Processing',
          '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏–∑ MRE': 'MRE Electrolysis',
          '–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è —à–ª–∞–∫–∞': 'Slag Distillation',
          '–°—Ç–µ–∫–ª–æ–≤–æ–ª–æ–∫–Ω–æ': 'Glass Fiber',
          '–õ–∏–Ω–∏—è —Ç–∏—Ç–∞–Ω–∞': 'Titanium Line',
          '–£–≥–ª–µ—Ä–æ–¥ (–æ–ø—Ü.)': 'Carbon (opt.)',
          '–ö—Ä–µ–º–Ω–∏–π': 'Silicon',
          '–ö–µ—Ä–∞–º–∏–∫–∞ MgO': 'MgO Ceramics',
          // Factory production
          '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–∞–≤–æ–¥–æ–≤': 'Factory Production',
          '–ü–ª–∞–≤–∫–∞': 'Melting',
          '–õ–∏—Ç—å–µ (–ú–ù–õ–ó)': 'Casting (CCM)',
          '–ü—Ä–æ–∫–∞—Ç': 'Rolling',
          '3D-–ø–µ—á–∞—Ç—å (WAAM)': '3D Printing (WAAM)',
          '–°–±–æ—Ä–∫–∞': 'Assembly',
          '–ö—É–ø–æ–ª–∞': 'Domes',
          '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': 'Equipment',
          '–°–∞–º–æ—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è': 'Self-Replication',
          // Mass drivers
          '–ú–∞—Å—Å-–¥—Ä–∞–π–≤–µ—Ä—ã': 'Mass Drivers',
          '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ú–î': 'MD Production',
          '–¢–µ–æ—Ä–∏—è –∏ –ö–ü–î': 'Theory & Efficiency',
          '–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ': 'Scaling',
          '–≠–ª–µ–º–µ–Ω—Ç—ã –ú–î': 'MD Components',
          '–†–µ–ª—å—Å—ã': 'Rails',
          '–ö–∞—Ç—É—à–∫–∏': 'Coils',
          '–ö–∞—Ä–∫–∞—Å': 'Frame',
          '–°–±–æ—Ä–∫–∞ –ú–î': 'MD Assembly',
          '–¢—Ä–µ–∫': 'Track',
          '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞': 'Electronics',
          '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ': 'Testing',
          // Robots
          '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–æ–±–æ—Ç–æ–≤': 'Robot Production',
          '–≠–ª–µ–º–µ–Ω—Ç—ã': 'Components',
          '–†–∞–º—ã': 'Frames',
          '–ë–∞—Ç–∞—Ä–µ–∏ (NaS)': 'Batteries (NaS)',
          '–ê–∫—Ç—É–∞—Ç–æ—Ä—ã': 'Actuators',
          '–°–±–æ—Ä–∫–∞ —Ä–æ–±–æ—Ç–æ–≤': 'Robot Assembly',
          '–ö—Ä–∞–±-–ú': 'Crab-M',
          '–ö–µ–Ω—Ç–∞–≤—Ä-–ú': 'Centaur-M',
          '–ö—Ä–æ—Ç-–ú': 'Mole-M',
          // Reference
          '–ì–ª–æ—Å—Å–∞—Ä–∏–π —Ç–µ—Ä–º–∏–Ω–æ–≤': 'Glossary',
          '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏': 'Technologies & Sources',
          '–§–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã': 'Physical Constants',
          '–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞': 'Nomenclature',
          '–†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞': 'Risks & Limitations'
        };

        function getBasePath() {
          const match = window.location.pathname.match(/^(.*?)\/(ru|en)\//);
          return match ? match[1] : '';
        }

        function getCurrentLang() {
          const basePath = getBasePath();
          const path = window.location.pathname;
          const escaped = basePath.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
          const pattern = new RegExp(`^${escaped}/(ru|en)/`);
          const match = path.match(pattern);
          return match ? match[1] : 'ru';
        }

        function switchLanguage(targetLang) {
          const basePath = getBasePath();
          const path = window.location.pathname;
          const currentLang = getCurrentLang();
          if (currentLang === targetLang) return;

          sessionStorage.setItem('scrollY', window.scrollY);

          const escaped = basePath.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
          const langPattern = new RegExp(`^(${escaped})/(ru|en)/`);
          let newPath = path.replace(langPattern, `$1/${targetLang}/`);

          // Root page handling
          if (path === basePath + '/' || path === basePath + '/index.html' || path === basePath) {
            newPath = `${basePath}/${targetLang}/`;
          }

          // Fallback –¥–ª—è –∫–Ω–∏–≥–∏ (–≥–ª–∞–≤—ã –Ω–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ EN)
          if (newPath.includes('/book/') && !newPath.endsWith('/book/') && !newPath.endsWith('/book/index.html')) {
            newPath = `${basePath}/${targetLang}/book/`;
          }

          window.location.href = newPath;
        }

        window.addEventListener('load', function() {
          const savedY = sessionStorage.getItem('scrollY');
          if (savedY) { window.scrollTo(0, parseInt(savedY)); sessionStorage.removeItem('scrollY'); }
        });

        document.addEventListener('DOMContentLoaded', function() {
          // Handle dropdown items for language switching
          document.querySelectorAll('.dropdown-item').forEach(el => {
            const text = el.textContent;
            for (const [langCode, flag] of Object.entries(LANG_FLAGS)) {
              if (text.includes(flag)) {
                el.addEventListener('click', function(e) { e.preventDefault(); switchLanguage(langCode); });
                if (langCode === getCurrentLang()) el.classList.add('active');
                break;
              }
            }
          });

          // Update navbar language indicator from üåê to current language label
          const currentLang = getCurrentLang();
          const currentLabel = LANG_LABELS[currentLang] || 'üåê';
          document.querySelectorAll('.navbar-nav .dropdown-toggle, .navbar-nav .nav-link').forEach(link => {
            if (link.textContent.trim() === 'üåê') {
              link.textContent = currentLabel;
            }
          });

          // Translate navigation labels for EN pages
          if (currentLang === 'en') {
            // Translate navbar items
            document.querySelectorAll('.navbar-nav .nav-link').forEach(el => {
              const text = el.textContent.trim();
              if (TRANSLATIONS[text]) {
                el.textContent = TRANSLATIONS[text];
              }
            });
            // Translate sidebar menu text
            document.querySelectorAll('.menu-text').forEach(el => {
              const text = el.textContent.trim();
              if (TRANSLATIONS[text]) {
                el.textContent = TRANSLATIONS[text];
              }
            });
            // Translate sidebar title
            document.querySelectorAll('.sidebar-title').forEach(el => {
              const text = el.textContent.trim();
              if (TRANSLATIONS[text]) {
                el.textContent = TRANSLATIONS[text];
              }
            });
          }

          // Rewrite ALL links (navbar + sidebar + content) to match current language
          document.querySelectorAll('a[href*="/ru/"]').forEach(link => {
            const href = link.getAttribute('href');
            if (href) {
              link.setAttribute('href', href.replace('/ru/', `/${currentLang}/`));
            }
          });

        });
        </script>

website:
  site-url: "https://DmitryNasikanov.github.io/infinite-energy"
  title: "–ü—Ä–æ–µ–∫—Ç –ì–µ–ª–∏–æ—Å"
  navbar:
    background: dark
    title: false
    right:
      - text: "üåê"
        menu:
          - text: "üá∑üá∫ –†—É—Å—Å–∫–∏–π"
            href: ru/index.qmd
          - text: "üá¨üáß English"
            href: en/index.qmd
    left:
      - text: "–ü—Ä–æ–µ–∫—Ç –ì–µ–ª–∏–æ—Å"
        href: ru/index.qmd
      - text: "–ö–Ω–∏–≥–∞"
        href: ru/book/index.qmd
      - text: "–ù–∞—É–∫–∞"
        href: ru/science/index.qmd
      - text: "–û–± –∞–≤—Ç–æ—Ä–µ"
        href: ru/about.qmd

  sidebar:
    - id: book
      title: "–ö–Ω–∏–≥–∞"
      style: "docked"
      contents:
        - text: "–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ"
          href: ru/book/index.qmd
        - section: "–ü—Ä–æ–ª–æ–≥"
          contents:
            - ru/book/00-prologue/00-prologue.qmd
        - section: "–ß–∞—Å—Ç—å I: –ú–∞–Ω–∏—Ñ–µ—Å—Ç –≤ —Ç–∏—à–∏–Ω–µ"
          contents:
            - ru/book/01-kabinety/01-kabinety.qmd
            - ru/book/02-shest-dney/02-shest-dney.qmd
            - ru/book/03-zvyozdy/03-zvyozdy.qmd
        - section: "–ß–∞—Å—Ç—å II: –†–µ–∑–æ–Ω–∞–Ω—Å"
          contents:
            - ru/book/04-rubilnik/04-rubilnik.qmd
            - ru/book/05-instruktazh/05-instruktazh.qmd
            - ru/book/06-soyuzniki/06-soyuzniki.qmd
            - ru/book/07-vashingtonskaya-stena/07-vashingtonskaya-stena.qmd
            - ru/book/08-snezhnyj-kom/08-snezhnyj-kom.qmd
        - section: "–ß–∞—Å—Ç—å III: –í–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ"
          contents:
            - ru/book/09-poligon/09-poligon.qmd
            - ru/book/10-luna/10-luna.qmd
            - ru/book/11-merkury/11-merkury.qmd

    - id: science
      title: "–ù–∞—É–∫–∞"
      style: "docked"
      contents:
        - text: "–û–±–∑–æ—Ä"
          href: ru/science/index.qmd
        - ru/science/executive-summary.qmd
        - section: "–°–≤–æ–¥–Ω—ã–µ —Å—Ç–∞—Ç—å–∏"
          contents:
            - ru/science/summaries/comparison.qmd
            - ru/science/summaries/moon.qmd
            #- ru/science/summaries/mercury.qmd  # stub, hidden until ready
            - ru/science/summaries/budget.qmd
            - ru/science/summaries/roadmap.qmd
            - text: "–ú–∞—Ä—Å (–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞)"
              href: ru/science/summaries/mars.qmd
        - section: "–î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–º—ã"
          contents:
            - ru/science/detailed/mirrors.qmd
            - ru/science/detailed/hub.qmd
            - ru/science/detailed/delivery.qmd
            - ru/science/detailed/production.qmd

            - section: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"
              contents:
                - text: "–ù–∞–≤–∏–≥–∞—Ü–∏—è"
                  href: ru/science/detailed/production/overview.qmd

                - section: "–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–æ–ª–∏—Ç–∞"
                  contents:
                    - text: "–û–±–∑–æ—Ä"
                      href: ru/science/detailed/production/materials/overview.qmd
                    - text: "–≠–ª–µ–∫—Ç—Ä–æ–ª–∏–∑ MRE"
                      href: ru/science/detailed/production/materials/mre.qmd
                    - text: "–î–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è —à–ª–∞–∫–∞"
                      href: ru/science/detailed/production/materials/distillation.qmd
                    - text: "–°—Ç–µ–∫–ª–æ–≤–æ–ª–æ–∫–Ω–æ"
                      href: ru/science/detailed/production/materials/silicate-fabric.qmd
                    - text: "–õ–∏–Ω–∏—è —Ç–∏—Ç–∞–Ω–∞"
                      href: ru/science/detailed/production/materials/titanium.qmd
                    - text: "–£–≥–ª–µ—Ä–æ–¥ (–æ–ø—Ü.)"
                      href: ru/science/detailed/production/materials/carbon.qmd
                    - text: "–ö—Ä–µ–º–Ω–∏–π"
                      href: ru/science/detailed/production/materials/silicon.qmd
                    - text: "–ö–µ—Ä–∞–º–∏–∫–∞ MgO"
                      href: ru/science/detailed/production/materials/ceramics-mgo.qmd

                - section: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–∞–≤–æ–¥–æ–≤"
                  contents:
                    - text: "–û–±–∑–æ—Ä"
                      href: ru/science/detailed/production/factories/overview.qmd
                    - section: "–≠–ª–µ–º–µ–Ω—Ç—ã"
                      contents:
                        - text: "–ü–ª–∞–≤–∫–∞"
                          href: ru/science/detailed/production/factories/elements/melting.qmd
                        - text: "–õ–∏—Ç—å–µ (–ú–ù–õ–ó)"
                          href: ru/science/detailed/production/factories/elements/casting.qmd
                        - text: "–ü—Ä–æ–∫–∞—Ç"
                          href: ru/science/detailed/production/factories/elements/rolling.qmd
                        - text: "3D-–ø–µ—á–∞—Ç—å (WAAM)"
                          href: ru/science/detailed/production/factories/elements/waam.qmd
                    - section: "–°–±–æ—Ä–∫–∞"
                      contents:
                        - text: "–ö—É–ø–æ–ª–∞"
                          href: ru/science/detailed/production/factories/assembly/domes.qmd
                        - text: "–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ"
                          href: ru/science/detailed/production/factories/assembly/equipment.qmd
                        - text: "–°–∞–º–æ—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è"
                          href: ru/science/detailed/production/factories/assembly/replication.qmd

                - section: "–ú–∞—Å—Å-–¥—Ä–∞–π–≤–µ—Ä—ã"
                  contents:
                    - text: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ú–î"
                      href: ru/science/detailed/production/railguns/overview.qmd
                    - text: "–¢–µ–æ—Ä–∏—è –∏ –ö–ü–î"
                      href: ru/science/detailed/production/railguns/theory.qmd
                    - text: "–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ"
                      href: ru/science/detailed/production/railguns/scaling.qmd
                    - section: "–≠–ª–µ–º–µ–Ω—Ç—ã –ú–î"
                      contents:
                        - text: "–†–µ–ª—å—Å—ã"
                          href: ru/science/detailed/production/railguns/elements/rails.qmd
                        - text: "–ö–∞—Ç—É—à–∫–∏"
                          href: ru/science/detailed/production/railguns/elements/coils.qmd
                        - text: "–ö–∞—Ä–∫–∞—Å"
                          href: ru/science/detailed/production/railguns/elements/frame.qmd
                    - section: "–°–±–æ—Ä–∫–∞ –ú–î"
                      contents:
                        - text: "–¢—Ä–µ–∫"
                          href: ru/science/detailed/production/railguns/assembly/track.qmd
                        - text: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
                          href: ru/science/detailed/production/railguns/assembly/electronics.qmd
                        - text: "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"
                          href: ru/science/detailed/production/railguns/assembly/testing.qmd

                - section: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–æ–±–æ—Ç–æ–≤"
                  contents:
                    - text: "–û–±–∑–æ—Ä"
                      href: ru/science/detailed/production/robots/overview.qmd
                    - section: "–≠–ª–µ–º–µ–Ω—Ç—ã"
                      contents:
                        - text: "–†–∞–º—ã"
                          href: ru/science/detailed/production/robots/elements/frames.qmd
                        - text: "–ë–∞—Ç–∞—Ä–µ–∏ (NaS)"
                          href: ru/science/detailed/production/robots/elements/batteries.qmd
                        - text: "–ê–∫—Ç—É–∞—Ç–æ—Ä—ã"
                          href: ru/science/detailed/production/robots/elements/actuators.qmd
                    - section: "–°–±–æ—Ä–∫–∞ —Ä–æ–±–æ—Ç–æ–≤"
                      contents:
                        - text: "–ö—Ä–∞–±-–ú"
                          href: ru/science/detailed/production/robots/assembly/crabs.qmd
                        - text: "–ö–µ–Ω—Ç–∞–≤—Ä-–ú"
                          href: ru/science/detailed/production/robots/assembly/centaurs.qmd
                        - text: "–ö—Ä–æ—Ç-–ú"
                          href: ru/science/detailed/production/robots/assembly/moles.qmd
        - section: "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏"
          contents:
            - ru/science/reference/technology-readiness.qmd
            - ru/science/reference/risks.qmd
            - ru/science/reference/glossary.qmd
            - ru/science/reference/constants.qmd
            - ru/science/reference/nomenclature.qmd
